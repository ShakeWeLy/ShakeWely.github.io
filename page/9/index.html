<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Weakliy_Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Weakliy_Blog">
<meta property="og:url" content="https://shakewely.github.io/page/9/index.html">
<meta property="og:site_name" content="Weakliy_Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Weakliy">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Weakliy_Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/plugin/bganimation/bg.css">

  

  <link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" rel="stylesheet" type="text/css">
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <div class="outer">
        <div class="widget-wrap mobile-header">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://raw.githubusercontent.com/ShakeWeLy/Weakliy.github.io/main/%E5%A4%B4%E5%83%8F/mmexport1683194148817.png">
    <h2 class="author">Weakliy</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>115</strong><br>文章</div></a>
      <a href="/categories"><div><strong>0</strong><br>分类</div></a>
      <a href="/tags"><div><strong>33</strong><br>标签</div></a>
    </div>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
    </ul>
  </div>
</div>

        <section id="main">
  
    <article id="post-2024年1月23日-python基础总结" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/01/23/2024%E5%B9%B41%E6%9C%8823%E6%97%A5-python%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/" class="article-date">
  <time class="post-time" datetime="2024-01-23T06:00:53.000Z" itemprop="datePublished">
    <span class="post-month">1月</span><br/>
    <span class="post-day">23</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/01/23/2024%E5%B9%B41%E6%9C%8823%E6%97%A5-python%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/">2024年1月23日 python语法总结</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="items"><a class="markdownIt-Anchor" href="#items"></a> <code>items()</code></h2>
<p>是 Python 字典中的一个方法，用于返回字典的键值对。</p>
<h2 id="装饰器"><a class="markdownIt-Anchor" href="#装饰器"></a> 装饰器@</h2>
<h4 id="普通方法不使用装饰器"><a class="markdownIt-Anchor" href="#普通方法不使用装饰器"></a> <code>普通方法（不使用装饰器）</code></h4>
<p>需要一个实例（<code>self</code>）作为第一个参数。普通方法通常用于操作类的<strong>实例</strong>属性和方法。</p>
<blockquote>
<h4 id="特点"><a class="markdownIt-Anchor" href="#特点"></a> 特点</h4>
<ul>
<li><strong>必须通过实例调用</strong>：普通方法需要先创建类的实例，然后通过实例调用方法。</li>
<li><strong>访问实例属性和方法</strong>：普通方法可以访问和修改实例的属性和其他方法。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj = MyClass(10)</span><br><span class="line">obj.normal_method()  # 输出：The value is 10</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="classmethod"><a class="markdownIt-Anchor" href="#classmethod"></a> <code>@classmethod</code></h4>
<p>用于定义<strong>类</strong>方法。类方法的第一个参数是<strong>类本身</strong>（通常命名为 <code>cls</code>），而不是实例（<code>self</code>）</p>
<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MyClass.class_method()  <span class="comment"># 输出：The class value is 100</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="staticmethod"><a class="markdownIt-Anchor" href="#staticmethod"></a> <code>@staticmethod</code></h4>
<p>用于定义静态方法。静态方法既不接收实例参数（<code>self</code>），也不接收类参数（<code>cls</code>），它就是一个普通的函数，<strong>只是恰好定义在类中</strong></p>
<blockquote>
<p><strong>独立于类和实例</strong></p>
<p>静态方法通常用于与类相关的工具函数或辅助函数</p>
</blockquote>
<img src="/2024/01/23/2024%E5%B9%B41%E6%9C%8823%E6%97%A5-python%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/image-20250623212618377.png" alt="image-20250623212618377" style="zoom: 80%;">
<h3 id="类是否需要实例化"><a class="markdownIt-Anchor" href="#类是否需要实例化"></a> 类是否需要实例化</h3>
<h4 id="看属性"><a class="markdownIt-Anchor" href="#看属性"></a> 看属性</h4>
<table>
<thead>
<tr>
<th>用法</th>
<th>什么时候用</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Functool.tools</code></td>
<td>如果 <code>tools</code> 是 <strong>类属性</strong> 或 <strong>类方法</strong>，用类来访问</td>
</tr>
<tr>
<td><code>functool_instance.tools</code></td>
<td>如果 <code>tools</code> 是 <strong>实例属性</strong> 或 <strong>实例方法</strong>，用对象来访问</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>如果你想要</th>
<th>推荐做法</th>
</tr>
</thead>
<tbody>
<tr>
<td>所有地方都用同一个配置（如 <code>tools</code>）</td>
<td>定义为 <strong>类属性</strong>，直接用 <code>Functool.tools</code></td>
</tr>
<tr>
<td>每个实例配置不同</td>
<td>定义为 <strong>实例属性</strong>，每次 <code>Functool()</code></td>
</tr>
</tbody>
</table>
<h2 id="python语法总结"><a class="markdownIt-Anchor" href="#python语法总结"></a> python语法总结</h2>
<h3 id="or"><a class="markdownIt-Anchor" href="#or"></a> or</h3>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">name = &quot;&quot;  # 空字符串</span><br><span class="line">result1 = name or &quot;默认值&quot;          # =&gt; &quot;默认值&quot;</span><br><span class="line">result2 = name if name is not None else &quot;默认值&quot;  # =&gt; &quot;&quot; （保留空字符串）</span><br><span class="line"></span><br><span class="line">print(result1)  # &quot;默认值&quot;</span><br><span class="line">print(result2)  # &quot;&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="__init__py实用示例"><a class="markdownIt-Anchor" href="#__init__py实用示例"></a> <code>__init__.py</code>实用示例</h2>
<p>一个比较标准的 <code>__init__.py</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">python复制编辑# 包元信息</span><br><span class="line">__version__ = &quot;1.0.0&quot;</span><br><span class="line">__author__ = &quot;OpenAI Learner&quot;</span><br><span class="line"></span><br><span class="line"># 导入核心功能</span><br><span class="line">from .core import CoreClass, helper_function</span><br><span class="line">from . import utils</span><br><span class="line"></span><br><span class="line"># 定义公开 API</span><br><span class="line">__all__ = [&quot;CoreClass&quot;, &quot;helper_function&quot;, &quot;utils&quot;]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果init是空的</p>
<p>from mypackage import Core  # ❌ 报错：找不到 Core<br>
from mypackage import utils  # ✅ OK，因为 utils 是个模块</p>
</blockquote>
<h2 id="class"><a class="markdownIt-Anchor" href="#class"></a> class</h2>
<h3 id="1-成员函数的变量-和成员变量"><a class="markdownIt-Anchor" href="#1-成员函数的变量-和成员变量"></a> 1 成员函数的变量 和成员变量</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">run_asr</span>(<span class="params">self, video_file_path, segment_duration=<span class="number">30</span></span>):</span><br></pre></td></tr></table></figure>
<blockquote>
<p>只有方法用到 那就作为参数</p>
<p>如果是全局变量可以用self成员变量/属性</p>
</blockquote>
<h4 id="类参数"><a class="markdownIt-Anchor" href="#类参数"></a> 类参数</h4>
<p><img src="/2024/01/23/2024%E5%B9%B41%E6%9C%8823%E6%97%A5-python%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/image-20250630224249641.png" alt="image-20250630224249641"></p>
<h3 id="2-类属性-vs-实例属性"><a class="markdownIt-Anchor" href="#2-类属性-vs-实例属性"></a> 2 类属性 vs 实例属性</h3>
<h4 id="1-类属性无需-self"><a class="markdownIt-Anchor" href="#1-类属性无需-self"></a> 1. <strong>类属性</strong>（无需 <code>self</code>）</h4>
<ul>
<li><strong>定义位置</strong>：直接在类内部定义，不在任何方法中。</li>
<li><strong>归属</strong>：属于类本身，所有实例共享同一个值。</li>
<li><strong>访问方式</strong>：通过类名或实例名访问（但不通过 <code>self</code>）。</li>
</ul>
<h4 id="2-实例属性必须用-self"><a class="markdownIt-Anchor" href="#2-实例属性必须用-self"></a> 2. <strong>实例属性</strong>（必须用 <code>self</code>）</h4>
<ul>
<li><strong>定义位置</strong>：通常在 <code>__init__</code> 方法或其他实例方法中通过 <code>self.属性名</code> 定义。</li>
<li><strong>归属</strong>：每个实例单独拥有，值可以不同。</li>
<li><strong>访问方式</strong>：只能通过实例对象（<code>self</code>）访问。</li>
</ul>
<h1 id="异步"><a class="markdownIt-Anchor" href="#异步"></a> 异步</h1>
<blockquote>
<img src="https://pic1.zhimg.com/70/v2-226c020e54407d7067a2abe194f444d8_1440w.image?source=172ae18b&biz_tag=Post" alt="什么是同步、异步，并发、并行、串行？" style="zoom:33%;"> 
<p>参考:<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/546752847">https://zhuanlan.zhihu.com/p/546752847</a></p>
</blockquote>
<table>
<thead>
<tr>
<th>对比项</th>
<th>同步 (Synchronous)</th>
<th>异步 (Asynchronous)</th>
<th>并发 (Concurrency)</th>
<th>并行 (Parallelism)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>概念</strong></td>
<td>按顺序执行，一个任务结束才做下一个</td>
<td>发起任务后可继续做别的，不等待结果</td>
<td>逻辑上同时做多事，快速切换</td>
<td>物理上同时做多事，需多核</td>
</tr>
<tr>
<td><strong>是否阻塞</strong></td>
<td>阻塞</td>
<td>非阻塞</td>
<td>通常非阻塞（依赖调度）</td>
<td>非阻塞</td>
</tr>
<tr>
<td><strong>是否真正同时运行</strong></td>
<td>否</td>
<td>否</td>
<td>否（单核快速切换）</td>
<td>是（多核同时跑）</td>
</tr>
<tr>
<td><strong>适合场景</strong></td>
<td>简单串行流程</td>
<td>高 IO 场景</td>
<td>IO 密集型任务</td>
<td>CPU 密集型任务</td>
</tr>
<tr>
<td><strong>Python常用方案</strong></td>
<td>普通函数</td>
<td><code>asyncio</code> / <code>await</code></td>
<td><code>threading</code></td>
<td><code>multiprocessing</code></td>
</tr>
<tr>
<td><strong>简单例子</strong></td>
<td><code>task(&quot;A&quot;); task(&quot;B&quot;)</code> 顺序</td>
<td><code>await task(&quot;A&quot;); await task(&quot;B&quot;)</code> 同时等</td>
<td>线程同时执行 <code>task(&quot;A&quot;)</code> 和 <code>task(&quot;B&quot;)</code></td>
<td>多进程同时执行 <code>task(&quot;A&quot;)</code> 和 <code>task(&quot;B&quot;)</code></td>
</tr>
</tbody>
</table>
<h2 id="or-2"><a class="markdownIt-Anchor" href="#or-2"></a> OR</h2>
<img src="/2024/01/23/2024%E5%B9%B41%E6%9C%8823%E6%97%A5-python%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/image-20250630224506782.png" alt="image-20250630224506782" style="zoom:50%;"> 

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shakewely.github.io/2024/01/23/2024%E5%B9%B41%E6%9C%8823%E6%97%A5-python%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/" data-id="cmbhxnxb00005gov4cy1zeep7" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-2024年1月23日-python库总结" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/01/23/2024%E5%B9%B41%E6%9C%8823%E6%97%A5-python%E5%BA%93%E6%80%BB%E7%BB%93/" class="article-date">
  <time class="post-time" datetime="2024-01-23T05:53:18.000Z" itemprop="datePublished">
    <span class="post-month">1月</span><br/>
    <span class="post-day">23</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/01/23/2024%E5%B9%B41%E6%9C%8823%E6%97%A5-python%E5%BA%93%E6%80%BB%E7%BB%93/">2024年1月23日 python库总结</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="httpx"><a class="markdownIt-Anchor" href="#httpx"></a> httpx</h2>
<p><code>httpx</code> 是一个比 <code>requests</code> 更适合现代 Python 应用（尤其是异步应用）的 HTTP 客户端。</p>
<blockquote>
<table>
<thead>
<tr>
<th>特性</th>
<th><code>requests</code></th>
<th><code>httpx</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>同步请求</strong></td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td><strong>异步请求</strong></td>
<td>❌</td>
<td>✅</td>
</tr>
<tr>
<td><strong>HTTP/2 支持</strong></td>
<td>❌</td>
<td>✅</td>
</tr>
<tr>
<td><strong>典型场景</strong></td>
<td>脚本、爬虫、小型服务</td>
<td>现代 Web 服务、异步微服务、FastAPI、HTTP/2</td>
</tr>
</tbody>
</table>
</blockquote>
<h2 id="pytest"><a class="markdownIt-Anchor" href="#pytest"></a> Pytest</h2>
<p><strong>心目的只有一个</strong>：<strong>验证程序的实际运行结果是否符合你预期的正确值。</strong></p>
<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line">   </span><br><span class="line"><span class="keyword">from</span> math_func <span class="keyword">import</span> add</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_add</span>():</span><br><span class="line">    <span class="keyword">assert</span> add(<span class="number">1</span>, <span class="number">2</span>) == <span class="number">3</span></span><br><span class="line">    <span class="keyword">assert</span> add(-<span class="number">1</span>, <span class="number">1</span>) == <span class="number">0</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>作用</p>
<blockquote>
<h2 id="️什么时候必须用工具"><a class="markdownIt-Anchor" href="#️什么时候必须用工具"></a> <strong>🗝️什么时候必须用工具</strong></h2>
<p>如果你的项目：</p>
<ul>
<li>测试文件很多（几十几百个）</li>
<li>每次手动执行麻烦</li>
<li>需要在 CI/CD 里自动跑（比如提交 PR 时自动跑所有测试）</li>
<li>需要统计覆盖率（哪些代码没被测到）</li>
<li>需要做参数化、大量组合测试</li>
</ul>
</blockquote>
<h2 id="ospath-和-pathlib"><a class="markdownIt-Anchor" href="#ospath-和-pathlib"></a> os.path 和 pathlib</h2>
<blockquote>
<p><strong><code>os.path</code> 是传统的、函数式的路径处理方式</strong>。</p>
<p><strong><code>pathlib</code> 是现代的、面向对象的路径处理方式（</strong></p>
</blockquote>
<blockquote>
<h3 id="1-路径拼接"><a class="markdownIt-Anchor" href="#1-路径拼接"></a> 1. 路径拼接</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python复制代码# os.path</span><br><span class="line">import os</span><br><span class="line">path = os.path.join(&quot;folder&quot;, &quot;file.txt&quot;)</span><br><span class="line"></span><br><span class="line"># pathlib</span><br><span class="line">from pathlib import Path</span><br><span class="line">path = Path(&quot;folder&quot;) / &quot;file.txt&quot;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="2-获取文件名"><a class="markdownIt-Anchor" href="#2-获取文件名"></a> 2. 获取文件名</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python复制代码# os.path</span><br><span class="line">filename = os.path.basename(&quot;/some/path/file.txt&quot;)</span><br><span class="line"></span><br><span class="line"># pathlib</span><br><span class="line">filename = Path(&quot;/some/path/file.txt&quot;).name</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3-判断文件是否存在"><a class="markdownIt-Anchor" href="#3-判断文件是否存在"></a> 3. 判断文件是否存在</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python复制代码# os.path</span><br><span class="line">os.path.exists(&quot;file.txt&quot;)</span><br><span class="line"></span><br><span class="line"># pathlib</span><br><span class="line">Path(&quot;file.txt&quot;).exists()</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="4-创建目录"><a class="markdownIt-Anchor" href="#4-创建目录"></a> 4. 创建目录</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python复制代码# os</span><br><span class="line">os.makedirs(&quot;folder/subfolder&quot;, exist_ok=True)</span><br><span class="line"></span><br><span class="line"># pathlib</span><br><span class="line">Path(&quot;folder/subfolder&quot;).mkdir(parents=True, exist_ok=True)</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h1 id="pathlibpath-常用方法大全"><a class="markdownIt-Anchor" href="#pathlibpath-常用方法大全"></a> 📁 <code>pathlib.Path</code> 常用方法大全</h1>
<hr>
<p>1️⃣ <strong><code>/</code> 运算符（joinpath）</strong> ✅<br>
重载 <code>/</code> 运算符实现路径拼接。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python复制代码from pathlib import Path</span><br><span class="line">p = Path(&quot;folder&quot;) / &quot;subfolder&quot; / &quot;file.txt&quot;</span><br><span class="line">print(p)  # folder/subfolder/file.txt</span><br></pre></td></tr></table></figure>
<hr>
<p>2️⃣ <strong><code>exists()</code></strong> ✅<br>
判断路径是否存在。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;somefile.txt&quot;).exists()  # True or False</span><br></pre></td></tr></table></figure>
<hr>
<p>3️⃣ <strong><code>is_file()</code></strong> ✅<br>
判断路径是否为文件。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;somefile.txt&quot;).is_file()  # True</span><br></pre></td></tr></table></figure>
<hr>
<p>4️⃣ <strong><code>is_dir()</code></strong> ✅<br>
判断路径是否为目录。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;myfolder&quot;).is_dir()  # True</span><br></pre></td></tr></table></figure>
<hr>
<p>5️⃣ <strong><code>mkdir(parents=False, exist_ok=False)</code></strong> ✅<br>
创建目录。可递归创建父目录。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;new/folder&quot;).mkdir(parents=True, exist_ok=True)</span><br></pre></td></tr></table></figure>
<hr>
<p>6️⃣ <strong><code>rmdir()</code></strong><br>
删除空目录。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;empty_folder&quot;).rmdir()</span><br></pre></td></tr></table></figure>
<hr>
<p>7️⃣ <strong><code>unlink()</code></strong><br>
删除文件（相当于 <code>os.remove()</code>）。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;temp.txt&quot;).unlink()</span><br></pre></td></tr></table></figure>
<hr>
<p>8️⃣ <strong><code>rename(target)</code></strong> ✅<br>
重命名或移动文件/文件夹。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;old_name.txt&quot;).rename(&quot;new_name.txt&quot;)</span><br></pre></td></tr></table></figure>
<hr>
<p>9️⃣ <strong><code>absolute()</code></strong><br>
获取绝对路径。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\</span><br><span class="line">print(Path(&quot;file.txt&quot;).absolute())</span><br></pre></td></tr></table></figure>
<hr>
<p>🔟 <strong><code>resolve(strict=False)</code></strong> ✅<br>
返回规范化的绝对路径（软链接也会解析）。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;file.txt&quot;).resolve()</span><br></pre></td></tr></table></figure>
<hr>
<p>1️⃣1️⃣ <strong><code>name</code></strong> ✅<br>
返回路径的最后一个部分（文件名或文件夹名）。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;/a/b/c.txt&quot;).name  # &#x27;c.txt&#x27;</span><br></pre></td></tr></table></figure>
<hr>
<p>1️⃣2️⃣ <strong><code>suffix</code></strong> ✅<br>
返回文件扩展名（含点）。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;report.pdf&quot;).suffix  # &#x27;.pdf&#x27;</span><br></pre></td></tr></table></figure>
<hr>
<p>1️⃣3️⃣ <strong><code>stem</code></strong> ✅<br>
返回文件名（不含扩展名）。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;report.pdf&quot;).stem  # &#x27;report&#x27;</span><br></pre></td></tr></table></figure>
<hr>
<p>1️⃣4️⃣ <strong><code>parent</code></strong> ✅<br>
返回上一级目录。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;/a/b/c.txt&quot;).parent  # Path(&#x27;/a/b&#x27;)</span><br></pre></td></tr></table></figure>
<hr>
<p>1️⃣5️⃣ <strong><code>parents</code></strong><br>
返回所有父目录的列表（可索引）。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python复制代码list(Path(&quot;/a/b/c.txt&quot;).parents)</span><br><span class="line"># [Path(&#x27;/a/b&#x27;), Path(&#x27;/a&#x27;), Path(&#x27;/&#x27;)]</span><br></pre></td></tr></table></figure>
<hr>
<p>1️⃣6️⃣ <strong><code>read_text(encoding='utf-8')</code></strong> ✅<br>
读取文本文件内容（简洁封装）。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;note.txt&quot;).read_text()</span><br></pre></td></tr></table></figure>
<hr>
<p>1️⃣7️⃣ <strong><code>write_text(data, encoding='utf-8')</code></strong> ✅<br>
写入文本文件内容（会覆盖）。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">Path(&quot;note.txt&quot;).write_text(&quot;Hello World!&quot;)</span><br></pre></td></tr></table></figure>
<hr>
<p>1️⃣8️⃣ <strong><code>read_bytes()</code></strong><br>
读取二进制文件内容。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">复制代码</span><br><span class="line">data = Path(&quot;image.png&quot;).read_bytes()</span><br></pre></td></tr></table></figure>
<hr>
<p>1️⃣9️⃣ <strong><code>Path.iterdir()</code></strong><br>
写入。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for child in p.iterdir():</span><br><span class="line">    print(child)</span><br></pre></td></tr></table></figure>
<hr>
<p>2️⃣0️⃣ <strong><code>glob(pattern)</code> / <code>rglob(pattern)</code></strong> ✅<br>
通配符匹配文件名（<code>rglob</code> 递归）。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python复制代码# 当前目录下所有txt</span><br><span class="line">list(Path(&quot;.&quot;).glob(&quot;*.txt&quot;))</span><br><span class="line"></span><br><span class="line"># 递归查找所有txt</span><br><span class="line">list(Path(&quot;.&quot;).rglob(&quot;*.txt&quot;))</span><br></pre></td></tr></table></figure>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shakewely.github.io/2024/01/23/2024%E5%B9%B41%E6%9C%8823%E6%97%A5-python%E5%BA%93%E6%80%BB%E7%BB%93/" data-id="cmcabapwe00006wv4fc0jdauy" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-2023年12月8日-深度学习训练总结" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/12/08/2023%E5%B9%B412%E6%9C%888%E6%97%A5-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%AE%AD%E7%BB%83%E6%80%BB%E7%BB%93/" class="article-date">
  <time class="post-time" datetime="2023-12-08T12:27:25.000Z" itemprop="datePublished">
    <span class="post-month">12月</span><br/>
    <span class="post-day">08</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/12/08/2023%E5%B9%B412%E6%9C%888%E6%97%A5-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%AE%AD%E7%BB%83%E6%80%BB%E7%BB%93/">2023年12月8日 深度学习训练总结</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-如何不用卷积对图片分类"><a class="markdownIt-Anchor" href="#1-如何不用卷积对图片分类"></a> 1 如何不用卷积对图片分类</h3>
<p>全连接神经网络，</p>
<p>HOG</p>
<h3 id="2-断点继续训练数据集是否保证不变比较好"><a class="markdownIt-Anchor" href="#2-断点继续训练数据集是否保证不变比较好"></a> 2 断点继续训练，数据集是否保证不变比较好</h3>
<h4 id="数据集不变的好处"><a class="markdownIt-Anchor" href="#数据集不变的好处"></a> 数据集不变的好处：</h4>
<ol>
<li><strong>一致性</strong>：在继续训练时使用相同的数据集，可以确保模型在相同的数据分布上进行训练，保持了训练的一致性。</li>
<li><strong>避免分布变化</strong>：如果数据集发生变化，可能会引入新的数据分布，导致模型在新数据上表现不佳。</li>
<li><strong>追溯性</strong>：如果需要回溯到特定训练点以排查问题或者进行对比实验，保持数据集不变会更容易复现相同的训练状态。</li>
</ol>
<h4 id="数据集变化的情况"><a class="markdownIt-Anchor" href="#数据集变化的情况"></a> 数据集变化的情况：</h4>
<ol>
<li><strong>数据扩充</strong>：有时候会对现有数据进行扩充、修正或更新，这种情况下训练过程中可能会引入新的数据。</li>
<li><strong>实时学习</strong>：某些场景下，模型需要不断从实时流数据中学习，此时数据集可能会不断变化。</li>
</ol>
<h3 id="3-训练的数据集不同加载预训练模型参数还有用吗"><a class="markdownIt-Anchor" href="#3-训练的数据集不同加载预训练模型参数还有用吗"></a> 3 训练的数据集不同，加载预训练模型参数还有用吗</h3>
<p>预训练模型在大规模数据集上进行了训练，学习到了<strong>通用的特征表示</strong>，可能有助于加速模型收敛并提高模型的表现。</p>
<p>如果你的训练数据集与预训练模型的训练数据集<strong>非常不同</strong>（，可能需要更多的微调或者甚至完全冻结预训练模型的参数。</p>
<h4 id="4-model-val准确率再80上不去"><a class="markdownIt-Anchor" href="#4-model-val准确率再80上不去"></a> 4 model val准确率再80上不去？</h4>
<img src="./2023年12月8日-深度学习训练总结/image-20231208224957461.png" alt="image-20231208224957461" style="zoom: 80%;" />
<h4 id="5-什么是梯度消失"><a class="markdownIt-Anchor" href="#5-什么是梯度消失"></a> 5 什么是梯度消失</h4>
<p>进行反向传播算法时，较低层的权重更新变得非常小甚至消失的现象。这种情况通常发生在很深的神经网络中</p>
<p>在反向传播期间，梯度会随着每一层的权重更新而逐渐减小。对于某些激活函数，特别是 Sigmoid 函数在输入很大或很小时会饱和，导致函数的梯度非常接近于零。</p>
<p><img src="./2023%E5%B9%B412%E6%9C%888%E6%97%A5-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%AE%AD%E7%BB%83%E6%80%BB%E7%BB%93/image-20231208233827091.png" alt="image-20231208233827091" /></p>
<h4 id="6-如何设置学习率衰减"><a class="markdownIt-Anchor" href="#6-如何设置学习率衰减"></a> 6 如何设置学习率衰减</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import torch.optim as optim</span><br><span class="line">from torch.optim import lr_scheduler</span><br><span class="line"></span><br><span class="line"># 定义模型和优化器</span><br><span class="line">model = YourModel()  # 请替换成您的模型</span><br><span class="line">optimizer = optim.SGD(model.parameters(), lr=0.1)  # 设置初始学习率</span><br><span class="line"></span><br><span class="line"># 定义学习率衰减器，例如 StepLR</span><br><span class="line"># StepLR 每隔 step_size 个epoch将学习率乘以 gamma</span><br><span class="line"># 这里可以根据需要选择其他的学习率衰减策略，如使用其他的调度器类</span><br><span class="line">scheduler = lr_scheduler.StepLR(optimizer, step_size=5, gamma=0.1)</span><br><span class="line"></span><br><span class="line"># 在训练过程中，每个 epoch 结束后更新学习率</span><br><span class="line">for epoch in range(num_epochs):</span><br><span class="line">    # 训练步骤，包括前向传播、损失计算、反向传播等</span><br><span class="line"></span><br><span class="line">    # 更新学习率</span><br><span class="line">    scheduler.step()</span><br><span class="line"></span><br><span class="line">    # 其他训练步骤</span><br><span class="line">    # ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shakewely.github.io/2023/12/08/2023%E5%B9%B412%E6%9C%888%E6%97%A5-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%AE%AD%E7%BB%83%E6%80%BB%E7%BB%93/" data-id="clrwazlr300117ov4fgy3an0d" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dl/" rel="tag">dl</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-2023年12月4日-PCA" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/12/04/2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/" class="article-date">
  <time class="post-time" datetime="2023-12-04T13:06:58.000Z" itemprop="datePublished">
    <span class="post-month">12月</span><br/>
    <span class="post-day">04</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/12/04/2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/">2023年12月4日 PCA</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="pca"><a class="markdownIt-Anchor" href="#pca"></a> PCA</h1>
<h2 id="1-pca原理"><a class="markdownIt-Anchor" href="#1-pca原理"></a> 1、PCA原理</h2>
<p>参考：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1E5411E71z/?spm_id_from=333.337.search-card.all.click&amp;vd_source=d3c0d5e026e5b0637b219503cea5513e">https://www.bilibili.com/video/BV1E5411E71z/?spm_id_from=333.337.search-card.all.click&amp;vd_source=d3c0d5e026e5b0637b219503cea5513e</a></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211124849.png" alt="image-20231204211124849" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211048339.png" alt="image-20231204211048339" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211113027.png" alt="image-20231204211113027" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211258728.png" alt="image-20231204211258728" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211356758.png" alt="image-20231204211356758" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211402550.png" alt="image-20231204211402550" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211416402.png" alt="image-20231204211416402" /><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211427283.png" alt="image-20231204211427283" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211423299.png" alt="image-20231204211423299" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211505125.png" alt="image-20231204211505125" /><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211617375.png" alt="image-20231204211617375" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211650063.png" alt="image-20231204211650063" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211739123.png" alt="image-20231204211739123" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211747417.png" alt="image-20231204211747417" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204211757163.png" alt="image-20231204211757163" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204212108183.png" alt="image-20231204212108183" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204212313493.png" alt="image-20231204212313493" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204212518333.png" alt="image-20231204212518333" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204212506525.png" alt="image-20231204212506525" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204212512462.png" alt="image-20231204212512462" /></p>
<p><img src="./2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/image-20231204212542766.png" alt="image-20231204212542766" /></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shakewely.github.io/2023/12/04/2023%E5%B9%B412%E6%9C%884%E6%97%A5-PCA/" data-id="clrwazlr3000y7ov4a2g29mne" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-2023年11月20日-面试总结2" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/11/20/2023%E5%B9%B411%E6%9C%8820%E6%97%A5-%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%932/" class="article-date">
  <time class="post-time" datetime="2023-11-19T16:49:22.000Z" itemprop="datePublished">
    <span class="post-month">11月</span><br/>
    <span class="post-day">20</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/11/20/2023%E5%B9%B411%E6%9C%8820%E6%97%A5-%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%932/">2023年11月20日 面试总结2</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>概况</strong>：</p>
<ul>
<li>面试时间：早上十点</li>
<li>面试岗位：</li>
<li>面试内容：自我介绍、专业领域、大创项目、Stable Diffusion项目、解释Diffusion模型、解释gam模型、计算机网络提问、深度学习提问、问答环节</li>
</ul>
<p><strong>面试内容总结</strong>：</p>
<ol>
<li><strong>自我介绍和专业领域</strong>：
<ul>
<li>面试官询问了你的专业和为何选择该岗位，但我似乎没有清晰地表达出你的专业优势和学院背景。</li>
</ul>
</li>
<li><strong>大创项目</strong>：
<ul>
<li>数据怎么处理</li>
<li>模型用了什么alexnet  似乎太过于简单</li>
<li>判断输出用的什么方式  概率sofmax</li>
<li></li>
</ul>
</li>
<li><strong>Stable Diffusion项目</strong>：
<ul>
<li>lora模型介绍  回答不好</li>
<li>项目使用经验 自我感觉还行</li>
</ul>
</li>
<li><strong>深度学习提问</strong>：
<ul>
<li>diffusion模型解释  临时抱佛脚的</li>
<li>过拟合和欠拟合解释——回答的思路很乱</li>
<li>解释gam模型——回答不好，</li>
</ul>
</li>
<li><strong>计算机网络提问</strong>：
<ul>
<li>问了计算机单线程和多线程组成原理下的实现？——没学过</li>
</ul>
</li>
<li>python<strong>提问：</strong>
<ol>
<li>python中可变数据类型有哪些——没背，没准备，</li>
</ol>
</li>
<li><strong>工作安排</strong>：
<ul>
<li>模型训练和脚本编写，方便美工作图</li>
</ul>
</li>
<li><strong>问答环节</strong>：
<ul>
<li>忘了——但是降维打击了已经</li>
</ul>
</li>
</ol>
<p><strong>总结</strong>：</p>
<p>​	学习不充分——还有很大没涉及的地方</p>
<p>​	准备不充分——很多没有按格式作答、思路很乱</p>
<p>​	心态爆炸——在专业人士面前简直是降维打击！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shakewely.github.io/2023/11/20/2023%E5%B9%B411%E6%9C%8820%E6%97%A5-%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%932/" data-id="clrwazlqy000i7ov4aofx9c7i" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-2023年11月17日-面试1总结" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/11/17/2023%E5%B9%B411%E6%9C%8817%E6%97%A5-%E9%9D%A2%E8%AF%951%E6%80%BB%E7%BB%93/" class="article-date">
  <time class="post-time" datetime="2023-11-17T10:06:15.000Z" itemprop="datePublished">
    <span class="post-month">11月</span><br/>
    <span class="post-day">17</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/11/17/2023%E5%B9%B411%E6%9C%8817%E6%97%A5-%E9%9D%A2%E8%AF%951%E6%80%BB%E7%BB%93/">2023年11月17日 面试1总结</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>概况</strong>：</p>
<ul>
<li>面试时间：15:38</li>
<li>面试岗位：工程项目与人工智能领域相关</li>
<li>面试内容：自我介绍、专业领域、大创项目、插件印象、开发插件想法、Stable Diffusion项目、工作要求和任务、问答环节</li>
</ul>
<p><strong>面试内容总结</strong>：</p>
<ol>
<li><strong>自我介绍和专业领域</strong>：
<ul>
<li>面试官询问了你的专业和为何选择该岗位，但我似乎没有清晰地表达出你的专业优势和学院背景。</li>
</ul>
</li>
<li><strong>大创项目</strong>：
<ul>
<li>提及了大创项目的流程和任务，但忽略了项目目的和实现方法，可能需要更注重解释项目的目标和你在项目中的角色。</li>
</ul>
</li>
<li><strong>插件印象和开发想法</strong>：
<ul>
<li>我提到了一个能阅读文献的插件，但在回答开发自己的插件时，没有明确表达插件的功能和目的。</li>
</ul>
</li>
<li><strong>Stable Diffusion项目</strong>：
<ul>
<li>解释了Stable Diffusion是一个与AI相关的热门产品，并且提到了你尝试使用该产品的功能制作了人脸和衣服模型。</li>
</ul>
</li>
<li><strong>工作要求和任务</strong>：
<ul>
<li>面试官没有明确说明具体的工作任务，只是模糊地提到了要对Chat GPT的最新资讯进行咨询并给公司做总结，涉及到AI产品的探索。</li>
</ul>
</li>
<li><strong>工作安排</strong>：
<ul>
<li>面试官询问你一天能到岗多少天，但工资是按日结算，似乎有所限制，需要确定到岗时间并考虑工资结算方式。</li>
</ul>
</li>
<li><strong>问答环节</strong>：
<ul>
<li>你问了关于具体工作任务能否线上完成的问题，但面试官似乎未给出明确答复。</li>
</ul>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shakewely.github.io/2023/11/17/2023%E5%B9%B411%E6%9C%8817%E6%97%A5-%E9%9D%A2%E8%AF%951%E6%80%BB%E7%BB%93/" data-id="clrwazlqx000g7ov48eub457k" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-2023年11月7日-量化3-Question" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/11/07/2023%E5%B9%B411%E6%9C%887%E6%97%A5-%E9%87%8F%E5%8C%963-Question/" class="article-date">
  <time class="post-time" datetime="2023-11-07T12:25:22.000Z" itemprop="datePublished">
    <span class="post-month">11月</span><br/>
    <span class="post-day">07</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/11/07/2023%E5%B9%B411%E6%9C%887%E6%97%A5-%E9%87%8F%E5%8C%963-Question/">2023年11月7日 量化3 Question</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-cuda"><a class="markdownIt-Anchor" href="#1-cuda"></a> 1 cuda</h2>
<p>NotImplementedError: Could not run ‘quantized::linear_prepack_fp16’ with arguments from the ‘CUDA’ backend.</p>
<p><strong>量化过程中使用到了一个不支持CUDA的操作。</strong></p>
<h3 id="1-为什么量化层少了acc却降低了"><a class="markdownIt-Anchor" href="#1-为什么量化层少了acc却降低了"></a> 1 为什么量化层少了，acc却降低了？</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">quantized_model = torch.quantization.quantize_dynamic(model, &#123;nn.Linear&#125;, dtype=torch.qint8)</span><br></pre></td></tr></table></figure>
<p><img src="/2023/11/07/2023%E5%B9%B411%E6%9C%887%E6%97%A5-%E9%87%8F%E5%8C%963-Question/image-20231107202610901.png" alt="image-20231107202610901"></p>
<p><img src="/2023/11/07/2023%E5%B9%B411%E6%9C%887%E6%97%A5-%E9%87%8F%E5%8C%963-Question/image-20231107202922407.png" alt="image-20231107202922407"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">quantized_model = torch.quantization.quantize_dynamic(model, &#123;nn.Linear, nn.Conv2d&#125;, dtype=torch.qint8)</span><br></pre></td></tr></table></figure>
<p><img src="/2023/11/07/2023%E5%B9%B411%E6%9C%887%E6%97%A5-%E9%87%8F%E5%8C%963-Question/image-20231107202605391.png" alt="image-20231107202605391"></p>
<p><img src="/2023/11/07/2023%E5%B9%B411%E6%9C%887%E6%97%A5-%E9%87%8F%E5%8C%963-Question/image-20231107202821307.png" alt="image-20231107202821307"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shakewely.github.io/2023/11/07/2023%E5%B9%B411%E6%9C%887%E6%97%A5-%E9%87%8F%E5%8C%963-Question/" data-id="clrwazlr0000o7ov4d56p813a" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%87%8F%E5%8C%96/" rel="tag">量化</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-2023年11月7日-深度学习报错日记" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/11/07/2023%E5%B9%B411%E6%9C%887%E6%97%A5-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%8A%A5%E9%94%99%E6%97%A5%E8%AE%B0/" class="article-date">
  <time class="post-time" datetime="2023-11-07T12:02:19.000Z" itemprop="datePublished">
    <span class="post-month">11月</span><br/>
    <span class="post-day">07</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/11/07/2023%E5%B9%B411%E6%9C%887%E6%97%A5-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%8A%A5%E9%94%99%E6%97%A5%E8%AE%B0/">2023年11月7日 深度学习报错日记</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>2</li>
</ul>
<p>RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same</p>
<p><strong>没有明确指定模型应该在GPU上运行。你可以使用<code>model.to(device)</code>将模型移动到GPU上</strong></p>
<ul>
<li>
<p>3</p>
<p>PIL.UnidentifiedImageError: cannot identify image file ‘F:\Dataset\PetImages\Cat\666.jpg’</p>
</li>
</ul>
<p><strong>图片损坏</strong></p>
<ul>
<li>继承Conv基类错误了</li>
</ul>
<p><img src="/2023/11/07/2023%E5%B9%B411%E6%9C%887%E6%97%A5-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%8A%A5%E9%94%99%E6%97%A5%E8%AE%B0/a1fc621421e9142e2c9efb319447d81.png" alt="a1fc621421e9142e2c9efb319447d81"></p>
<p><img src="/2023/11/07/2023%E5%B9%B411%E6%9C%887%E6%97%A5-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%8A%A5%E9%94%99%E6%97%A5%E8%AE%B0/8906c28d1e2f7e77d19994f0a920f62.png" alt="8906c28d1e2f7e77d19994f0a920f62"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shakewely.github.io/2023/11/07/2023%E5%B9%B411%E6%9C%887%E6%97%A5-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%8A%A5%E9%94%99%E6%97%A5%E8%AE%B0/" data-id="clrwazlr1000q7ov430ep5euf" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dl/" rel="tag">dl</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-2023年10月24日-TensorRT1介绍" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/10/24/2023%E5%B9%B410%E6%9C%8824%E6%97%A5-TensorRT1%E4%BB%8B%E7%BB%8D/" class="article-date">
  <time class="post-time" datetime="2023-10-24T11:51:56.000Z" itemprop="datePublished">
    <span class="post-month">10月</span><br/>
    <span class="post-day">24</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/10/24/2023%E5%B9%B410%E6%9C%8824%E6%97%A5-TensorRT1%E4%BB%8B%E7%BB%8D/">2023年10月24日 TensorRT1介绍</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-什么是tensorrt"><a class="markdownIt-Anchor" href="#1-什么是tensorrt"></a> 1 什么是TensorRT</h2>
<h3 id="11-tensorrt介绍"><a class="markdownIt-Anchor" href="#11-tensorrt介绍"></a> 1.1 <strong>TensorRT介绍</strong></h3>
<p>TensorRT是可以在<strong>NVIDIA</strong>各种<strong>GPU硬件平台</strong>下运行的一个<strong>C++推理框架</strong>。</p>
<p>我们利用Pytorch训练好的模型，可以转化为TensorRT的格式，然后利用TensorRT推理引擎去运行我们这个模型，从而提升这个模型在英伟达GPU上运行的速度。<strong>速度提升</strong>的比例是<strong>比较可观</strong>的。</p>
<h3 id="12-tensorrt-工作流程"><a class="markdownIt-Anchor" href="#12-tensorrt-工作流程"></a> 1.2 TensorRT 工作流程</h3>
<img src="/2023/10/24/2023%E5%B9%B410%E6%9C%8824%E6%97%A5-TensorRT1%E4%BB%8B%E7%BB%8D/.Hexo/MyBlog/source/_posts/2023年10月12日-TensorRT介绍/image-20250314191334384.png" alt="image-20250314191334384" style="zoom: 25%;">
<h3 id="13-为什么能加速"><a class="markdownIt-Anchor" href="#13-为什么能加速"></a> 1.3 为什么能加速？</h3>
<ul>
<li>
<p><strong>算子融合(层与张量融合)</strong>：简单来说就是通过融合一些计算op或者去掉一些多余op来<strong>减少数据流通次数以及显存的频繁使用来提速</strong>，使用更少的cuda核心</p>
<img src="/2023/10/24/2023%E5%B9%B410%E6%9C%8824%E6%97%A5-TensorRT1%E4%BB%8B%E7%BB%8D/.Hexo\MyBlog\source\_posts\2023年10月12日-TensorRT介绍\image-20250314190650887.png" alt="image-20250314190650887" style="zoom: 50%;">
</li>
<li>
<p><strong>量化</strong>：量化即IN8量化或者FP16以及TF32等不同于常规FP32精度的使用，这些精度可以显著提升模型执行速度并且不会保持原先模型的精度</p>
</li>
<li>
<p><strong>内核自动调整</strong>：根据不同的显卡构架、SM数量、内核频率等(例如1080TI和2080TI)，选择不同的优化策略以及计算方式，寻找最合适当前构架的计算方式<code>对特定显卡进行特定优化</code>为模型的每一层选择最优化的GPU 内核。这种自适应方法可确保模型充分利用 GPU 的计算能力。</p>
<img src="/2023/10/24/2023%E5%B9%B410%E6%9C%8824%E6%97%A5-TensorRT1%E4%BB%8B%E7%BB%8D/.Hexo/MyBlog/source/_posts/2023年10月12日-TensorRT介绍/image-20231012202620295.png" alt="image-20231012202620295" style="zoom: 33%;">
</li>
<li>
<p><strong>动态张量显存</strong>/<strong>动态Tensor 内存管理</strong>：TensorRT 在推理过程中有效管理tensor 内存使用情况，减少内存开销并优化内存分配。这使得GPU 的内存使用效率更高。</p>
</li>
<li>
<p><strong>多流执行</strong>：使用CUDA中的stream技术，最大化实现并行操作</p>
</li>
</ul>
<h3 id="14-tensorrt的加速效果怎么样"><a class="markdownIt-Anchor" href="#14-tensorrt的加速效果怎么样"></a> 1.<strong>4 TensorRT的加速效果怎么样</strong></h3>
<p>加速效果取决于模型的类型和大小，也取决于我们所使用的显卡类型。</p>
<p>TensorRT所做的优化也是<strong>基于GPU</strong>进行优化，当然也是更喜欢那种一大块一大块的矩阵运算，尽量直通到底。因此对于通道数比较多的卷积层和反卷积层，优化力度是比较大的；</p>
<p>如果是比较繁多复杂的各种细小op操作**(例如reshape、gather、split等)，那么TensorRT的优化力度就没有那么夸张了。**</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">所以在转onnx的时候需要对模型进行修改，减少reshape等</span><br></pre></td></tr></table></figure>
<h3 id="15概念和使用方式"><a class="markdownIt-Anchor" href="#15概念和使用方式"></a> 1.5概念和使用方式</h3>
<ul>
<li>
<p>支持模型、数据类型、支持的IO、支持的功能</p>
</li>
<li>
<p>TensorRT中context、engine、builder概念</p>
</li>
<li>
<p>环境搭建、运行环境</p>
<p><strong>1.5 什么是算子</strong></p>
<p>有时候自己会设计一些layer来满足任务需求，但是这些layer在使用Tensorrt优化时，TensorRT可能并不支持。</p>
<p>这时候就需要自己写一个算子/<strong>Plugin</strong> 来实现</p>
<img src="/2023/10/24/2023%E5%B9%B410%E6%9C%8824%E6%97%A5-TensorRT1%E4%BB%8B%E7%BB%8D/.Hexo/MyBlog/source/_posts/2023年10月12日-TensorRT介绍/image-20250314191142137.png" alt="image-20250314191142137" style="zoom: 25%;">
</li>
</ul>
<h3 id="16-工作流程"><a class="markdownIt-Anchor" href="#16-工作流程"></a> 1.6 工作流程</h3>
<ul>
<li>python端API</li>
<li>C++端API</li>
<li>简单的demo</li>
</ul>
<h2 id="2-tensorrt完整流程"><a class="markdownIt-Anchor" href="#2-tensorrt完整流程"></a> 2 TensorRT完整流程</h2>
<h3 id="21-onnx转tensorrt"><a class="markdownIt-Anchor" href="#21-onnx转tensorrt"></a> 2.1 ONNX转TensorRT</h3>
<ul>
<li>parser方式转换模型</li>
<li>onnx2trt简单分析</li>
<li>graphsurgeon修改onnx网络</li>
<li>一些注意点</li>
</ul>
<h3 id="22-框架内使用tensorrt"><a class="markdownIt-Anchor" href="#22-框架内使用tensorrt"></a> 2.2 框架内使用tensorrt</h3>
<ul>
<li>torch_tensorrt介绍、使用</li>
<li>torch_tensorrt源码解析</li>
</ul>
<h2 id="3-tensorrt进阶操作"><a class="markdownIt-Anchor" href="#3-tensorrt进阶操作"></a> 3 TensorRT进阶操作</h2>
<h3 id="31-如何debug"><a class="markdownIt-Anchor" href="#31-如何debug"></a> 3.1 如何debug</h3>
<ul>
<li>精度问题debug（nan、精度不匹配）</li>
<li>网络可视化（netron、trt-explorer）</li>
<li>polygraphy（TensorRT官方提供的非常好的工具）</li>
</ul>
<h3 id="32-api搭建网络"><a class="markdownIt-Anchor" href="#32-api搭建网络"></a> 3.2 API搭建网络</h3>
<ul>
<li>API搭建网络基本方式、权重提取，这部分强烈建议看TensorRTx</li>
<li>explicit batch vs implicit batch</li>
</ul>
<h3 id="33-自定义插件plugin"><a class="markdownIt-Anchor" href="#33-自定义插件plugin"></a> 3.3 自定义插件plugin</h3>
<ul>
<li>如何写自定义plugin、Plugin中关键的API与注意点</li>
<li>自定义插件示例、集成plugin到trt中、参与trt序列化</li>
<li>plugin的生命周期、资源管理</li>
<li>dynamic-shape-plugin</li>
<li>Plugin的FP16和INT8</li>
</ul>
<h3 id="34-常见疑难杂症"><a class="markdownIt-Anchor" href="#34-常见疑难杂症"></a> 3.4 常见疑难杂症</h3>
<ul>
<li>各种log中的报错</li>
</ul>
<h2 id="4-tensorrt最佳使用指南"><a class="markdownIt-Anchor" href="#4-tensorrt最佳使用指南"></a> 4 TensorRT最佳使用指南</h2>
<h3 id="41-如何正确使用trtexec"><a class="markdownIt-Anchor" href="#41-如何正确使用trtexec"></a> 4.1 如何正确使用trtexec</h3>
<ul>
<li>trtexec基本用法</li>
<li>动态尺度、设置optimization profile以及注意点（min-opt-max）</li>
<li>trtexec源码解析</li>
</ul>
<h3 id="42-提升性能"><a class="markdownIt-Anchor" href="#42-提升性能"></a> 4.2 提升性能</h3>
<ul>
<li>多steam（重叠计算和数据拷贝的时间，增加GPU利用率）</li>
<li>多context（多线程推理）</li>
<li>多optimization profile</li>
<li>CUDA Graph（减少kernel launch时间）</li>
<li>Timing Cache（减少build时间）</li>
<li>Algorithm Selector</li>
</ul>
<h3 id="43-tensorrt转换相关"><a class="markdownIt-Anchor" href="#43-tensorrt转换相关"></a> 4.3 TensorRT转换相关</h3>
<ul>
<li>某些Layer选择的算法导致误差大，屏蔽掉该选择 tactic Source</li>
<li>更新权重refit功能（强化学习用的多）</li>
<li>构建期/运行期显存占用大（调整参数以及策略）</li>
</ul>
<h2 id="5-tensorrt量化"><a class="markdownIt-Anchor" href="#5-tensorrt量化"></a> 5 TensorRT量化</h2>
<h3 id="ptq"><a class="markdownIt-Anchor" href="#ptq"></a> PTQ</h3>
<h3 id="qat"><a class="markdownIt-Anchor" href="#qat"></a> QAT</h3>
<ul>
<li>fake_</li>
<li>QDQ 节点</li>
</ul>
<h3 id="tensorrt-fp16"><a class="markdownIt-Anchor" href="#tensorrt-fp16"></a> TensorRT-FP16</h3>
<ul>
<li>fp16精度设置与使用</li>
<li>fp16常见问题</li>
</ul>
<h3 id="tensorrt-int8"><a class="markdownIt-Anchor" href="#tensorrt-int8"></a> TensorRT-INT8</h3>
<ul>
<li>int8使用</li>
<li>PTQ校准集</li>
<li>QAT量化</li>
</ul>
<h3 id="混合精度"><a class="markdownIt-Anchor" href="#混合精度"></a> 混合精度</h3>
<ul>
<li>fp32和fp16</li>
<li>fp16和int8</li>
</ul>
<h2 id="6-tensorrt拓展"><a class="markdownIt-Anchor" href="#6-tensorrt拓展"></a> 6 TensorRT拓展</h2>
<h3 id="61-tensorrt转换的几种方式"><a class="markdownIt-Anchor" href="#61-tensorrt转换的几种方式"></a> 6.1 TensorRT转换的几种方式</h3>
<ul>
<li>torch2trt</li>
<li>torchscript2trt</li>
<li>fx2trt</li>
</ul>
<h2 id="7-tensorrt实战"><a class="markdownIt-Anchor" href="#7-tensorrt实战"></a> 7 TensorRT实战</h2>
<h3 id="61-检测模型转换"><a class="markdownIt-Anchor" href="#61-检测模型转换"></a> 6.1 检测模型转换</h3>
<ul>
<li>SSD模型转TensorRT dynamic-shape</li>
<li>带有自定义DCN-OP的CenterNet转TensorRT</li>
</ul>
<h3 id="62-识别-分割-nlp类模型"><a class="markdownIt-Anchor" href="#62-识别-分割-nlp类模型"></a> 6.2 识别、分割、nlp类模型</h3>
<ul>
<li>stable diffusion</li>
<li>GPT</li>
</ul>
<h3 id="63-tensorrttriton-inference-server线上线下部署"><a class="markdownIt-Anchor" href="#63-tensorrttriton-inference-server线上线下部署"></a> 6.3 TensorRT+triton-inference-server线上/线下部署</h3>
<ul>
<li>基本部署教程</li>
<li>大规模TensorRT模型部署、多卡、模型调度</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shakewely.github.io/2023/10/24/2023%E5%B9%B410%E6%9C%8824%E6%97%A5-TensorRT1%E4%BB%8B%E7%BB%8D/" data-id="cmanj8o1q0001lcv4fsd382ib" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TensorRT/" rel="tag">TensorRT</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-2023年10月19日-量化2代码实现" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/10/19/2023%E5%B9%B410%E6%9C%8819%E6%97%A5-%E9%87%8F%E5%8C%962%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/" class="article-date">
  <time class="post-time" datetime="2023-10-19T08:49:29.000Z" itemprop="datePublished">
    <span class="post-month">10月</span><br/>
    <span class="post-day">19</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/10/19/2023%E5%B9%B410%E6%9C%8819%E6%97%A5-%E9%87%8F%E5%8C%962%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/">2023年10月19日 量化2代码实现</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://blog.csdn.net/kuan__/article/details/109539007">https://blog.csdn.net/kuan__/article/details/109539007</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42506418/article/details/131234818">https://blog.csdn.net/weixin_42506418/article/details/131234818</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ljp1919/article/details/126231261">https://blog.csdn.net/ljp1919/article/details/126231261</a></p>
<h2 id="3-训练后动态量化技术dynamic-quantization"><a class="markdownIt-Anchor" href="#3-训练后动态量化技术dynamic-quantization"></a> 3 **训练后动态量化技术（dynamic quantization）</h2>
<p>将模型的权重从浮点精度（例如32位浮点数）转换为低精度整数类型（例如8位整数）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">quantized_model = torch.quantization.quantize_dynamic(model, &#123;nn.Linear, nn.Conv2d&#125;, dtype=torch.qint8)</span><br></pre></td></tr></table></figure>
<ol>
<li><code>model</code>: 这个变量应该是你想要进行量化的原始PyTorch模型，它可能是使用<code>torch.nn.Module</code>类定义的神经网络模型。</li>
<li><code>&#123;nn.Linear, nn.Conv2d&#125;</code>: 这个参数指定了你希望量化的模型层类型。在这个例子中，<code>nn.Linear</code>和<code>nn.Conv2d</code>表示对模型中的线性层和二维卷积层进行量化。
<ol>
<li><strong>线性层（Linear Layers）</strong>：<code>nn.Linear</code></li>
<li><strong>卷积层（Convolutional Layers）</strong>：<code>nn.Conv1d</code>, <code>nn.Conv2d</code>, <code>nn.Conv3d</code></li>
<li><strong>循环神经网络层（Recurrent Layers）</strong>：<code>nn.RNN</code>, <code>nn.LSTM</code>, <code>nn.GRU</code></li>
<li><strong>批归一化层（Batch Normalization Layers）</strong>：<code>nn.BatchNorm1d</code>, <code>nn.BatchNorm2d</code>, <code>nn.BatchNorm3d</code></li>
<li><strong>激活函数（Activation Functions）</strong>：<code>nn.ReLU</code>, <code>nn.LeakyReLU</code>, <code>nn.PReLU</code>, <code>nn.ReLU6</code>, 等等。</li>
<li><strong>池化层（Pooling Layers）</strong>：<code>nn.MaxPool1d</code>, <code>nn.MaxPool2d</code>, <code>nn.AvgPool1d</code>, <code>nn.AvgPool2d</code>, 等等。</li>
</ol>
</li>
<li><code>dtype=torch.qint8</code>: 这个参数指定了量化后的数据类型，这里是8位整数（qint8）。在推断时，量化模型将使用这种低精度整数类型进行计算。
<ol>
<li><strong><code>torch.qint8</code></strong>: 8位有符号整数。通常用于量化权重和激活值。</li>
<li><strong><code>torch.quint8</code></strong>: 8位无符号整数。通常用于量化正数的权重和激活值。</li>
<li><strong><code>torch.qint32</code></strong>: 32位有符号整数。通常用于量化权重和激活值。</li>
<li><strong><code>torch.float16</code></strong>: 16位浮点数。通常用于量化权重和激活值。不是整数量化，但比32位浮点数（<code>torch.float32</code>）占用更少内存。</li>
<li><strong><code>torch.bfloat16</code></strong>: 16位浮点数（Brain Floating Point）</li>
</ol>
</li>
</ol>
<h2 id="4-量化感知训练"><a class="markdownIt-Anchor" href="#4-量化感知训练"></a> 4 <strong>量化感知训练</strong></h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.quantization.FakeQuantize QAT</span><br></pre></td></tr></table></figure>
<p><strong>get_default_qconfig</strong></p>
<p>​	在使用量化（quantization）技术时，PyTorch会改变模型的结构，并为每个权重参数添加量化相关的信息。因此需要重新写一个量化model</p>
<p>量化后的模型（quantized model）的state_dict的键（keys）与原始模型的state_dict的键不匹配。</p>
<p>使用<code>torch.quantization.quantize_dynamic()</code>对模型进行量化时，它会在state_dict中添加与量化参数相关的额外键（比如scale、zero_point、dtype和_packed_params）。</p>
<p>为了解决这个问题，需要修改加载量化模型的代码。在加载量化模型的state_dict时，应该指定<code>map_location</code>参数，将量化模型的参数映射到适当的设备（GPU或CPU）（设备不匹配的错误）。此外，你需要传递<code>strict=False</code>参数给<code>load_state_dict()</code>，忽略量化模型state_dict中存在的额外键。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shakewely.github.io/2023/10/19/2023%E5%B9%B410%E6%9C%8819%E6%97%A5-%E9%87%8F%E5%8C%962%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/" data-id="clrwazlqu00057ov4bn1tbi46" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%87%8F%E5%8C%96/" rel="tag">量化</a></li></ul>

    </footer>
  </div>
  
</article>




  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/8/">&amp;laquo; pre</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/10/">next &amp;raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <h1 class="blog-title">Weakliy_Blog</h1>
    <h2 class="blog-subtitle"></h2>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
    </ul>
  </div>
</div>

  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://raw.githubusercontent.com/ShakeWeLy/Weakliy.github.io/main/%E5%A4%B4%E5%83%8F/mmexport1683194148817.png">
    <h2 class="author">Weakliy</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>115</strong><br>文章</div></a>
      <a href="/categories"><div><strong>0</strong><br>分类</div></a>
      <a href="/tags"><div><strong>33</strong><br>标签</div></a>
    </div>



    <div class="social-link">
      
        <a class="hvr-bounce-in" href="https://github.com/ShakeWeLy" target="_blank" title="Github">
          Github
        </a>
      
    </div>

    <div class="friend-link">
      <h2>联系我</h2>
      
        <a class="hvr-bounce-in" href="https://github.com/ShakeWeLy" target="_blank" title="ShanaMaid">
          ShanaMaid
        </a>
      
    </div>
  </div>
</div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy;2024 - 2025 Weakliy<br>
      由<a href="http://hexo.io/" target="_blank">Hexo</a>强力驱动 | 
      主题-<a target="_blank" rel="noopener" href="https://github.com/ShanaMaid/hexo-theme-shana">Shana</a>
      
    </div>
    
  </div>
</footer>
    </div>
    

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="//apps.bdimg.com/libs/wow/0.1.6/wow.min.js"></script>
<script>
new WOW().init();
</script>   


  
<link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css">

  
<script src="/plugin/fancybox/jquery.fancybox.pack.js"></script>




  
<link rel="stylesheet" href="/plugin/galmenu/GalMenu.css">

  
<script src="/plugin/galmenu/GalMenu.js"></script>

  <div class="GalMenu GalDropDown">
      <div class="circle" id="gal">
        <div class="ring">
          
            <a href="/" title="" class="menuItem">首页</a>
          
            <a href="/tags" title="" class="menuItem">标签</a>
          
            <a href="/categories" title="" class="menuItem">分类</a>
          
            <a href="/archives" title="" class="menuItem">总览</a>
          
            <a href="/xxxxxxxxx" title="" class="menuItem">xxx</a>
          
            <a href="/xxxxxxx" title="" class="menuItem">xxxx</a>
          
        </div>
        
          <audio id="audio" src="#"></audio>
        
      </div> 
</div>
<div id="overlay" style="opacity: 1; cursor: pointer;"></div>
  <script type="text/javascript">var items = document.querySelectorAll('.menuItem');
    for (var i = 0,
    l = items.length; i < l; i++) {
      items[i].style.left = (50 - 35 * Math.cos( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%";
      items[i].style.top = (50 + 35 * Math.sin( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%"
    }</script>
<script type="text/javascript">
  $(document).ready(function() {
    $('body').GalMenu({
      'menu': 'GalDropDown'
    })
  });
</script>

  <section class="hidden-xs"> 
  <ul class="cb-slideshow"> 
    <li><span>苟利</span></li> 
    <li><span>国家</span></li> 
    <li><span>生死以</span></li> 
    <li><span>岂能</span></li> 
    <li><span>祸福</span></li> 
    <li><span>趋避之</span></li> 
  </ul>
</section>

<script src="/js/script.js"></script>




  </div>
</body>
</html>